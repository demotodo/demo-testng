# org.testng.Reporter

This class is used for test methods to log messages that will be included in the HTML reports generated by TestNG.

```
  // when tests are run in parallel, each thread may be working with different
  // 'current test result'. Also, this value should be inherited if the test code
  // spawns its own thread.
  private static ThreadLocal<ITestResult> m_currentTestResult = new InheritableThreadLocal<>();

  //This variable is responsible for persisting all output that is yet to be associated with any
  //valid TestResult objects.
  private static ThreadLocal<List<String>> m_orphanedOutput = new InheritableThreadLocal<>();


  private static synchronized void log(String s, ITestResult m) {
    // Escape for the HTML reports
    if (m_escapeHtml) {
      s = Strings.escapeHtml(s);
    }

    if (m == null) {
      //Persist the output temporarily into a Threadlocal String list.
      if (m_orphanedOutput.get() == null) {
        m_orphanedOutput.set(new ArrayList<String>());
      }
      m_orphanedOutput.get().add(s);
      return;
    }

    // synchronization needed to ensure the line number and m_output are updated atomically
    int n = getOutput().size();

    List<Integer> lines = m_methodOutputMap.get(m.hashCode());
    if (lines == null) {
      lines = Lists.newArrayList();
      m_methodOutputMap.put(m.hashCode(), lines);
    }

    // Check if there was already some orphaned output for the current thread.
    if (m_orphanedOutput.get() != null) {
      n = n + m_orphanedOutput.get().size();
      getOutput().addAll(m_orphanedOutput.get());
      // Since we have already added all of the orphaned output to the current
      // TestResult, lets clear it off
      m_orphanedOutput.remove();
    }
    lines.add(n);
    getOutput().add(s);
  }

  public static void log(String s) {
    log(s, getCurrentTestResult());
  }
  
  public static ITestResult getCurrentTestResult() {
    return m_currentTestResult.get();
  }


  public static void log(String s, int level, boolean logToStandardOut) {
    if (TestRunner.getVerbose() >= level) {
      log(s, getCurrentTestResult());
      if (logToStandardOut) {
        System.out.println(s);
      }
    }
  }
```
